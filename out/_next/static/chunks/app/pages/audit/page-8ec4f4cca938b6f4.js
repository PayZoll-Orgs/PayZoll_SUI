(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8149],{9718:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(95155),r=s(12115),l=s(53791);let n=()=>{let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[c,i]=(0,r.useState)(null),[d,o]=(0,r.useState)("all"),[x,p]=(0,r.useState)(!1);async function m(){try{n(!0);let e=await l.L.getAllAuditRecords();t(e),n(!1)}catch(e){console.error("Error fetching audit data:",e),i("Failed to load audit data from blockchain"),n(!1)}}(0,r.useEffect)(()=>{m()},[]);let h=e=>new Date(e).toLocaleString(),u=e=>!e||e.length<=12?e:"".concat(e.substring(0,6),"...").concat(e.substring(e.length-6)),g=e=>{switch(e){case"invoice":return"bg-blue-100 text-blue-800";case"payroll":return"bg-green-100 text-green-800";case"splitBill":return"bg-purple-100 text-purple-800";case"payment":return"bg-amber-100 text-amber-800";default:return"bg-gray-100 text-gray-800"}},y=e=>{switch(e){case"send":return"bg-blue-100 text-blue-800";case"claim":return"bg-green-100 text-green-800";case"reimburse":return"bg-amber-100 text-amber-800";default:return"bg-gray-100 text-gray-800"}},b="all"===d?e:e.filter(e=>e.recordType===d),j=async()=>{p(!0);try{await l.L.recoverAuditIndex(),m()}catch(e){console.error("Error recovering audit index:",e)}finally{p(!1)}};return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Blockchain Audit Records"}),(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>o("all"),className:"px-3 py-1 rounded text-sm ".concat("all"===d?"bg-gray-800 text-white":"bg-gray-200"),children:"All"}),(0,a.jsx)("button",{onClick:()=>o("invoice"),className:"px-3 py-1 rounded text-sm ".concat("invoice"===d?"bg-blue-600 text-white":"bg-blue-100"),children:"Invoices"}),(0,a.jsx)("button",{onClick:()=>o("payroll"),className:"px-3 py-1 rounded text-sm ".concat("payroll"===d?"bg-green-600 text-white":"bg-green-100"),children:"Payrolls"}),(0,a.jsx)("button",{onClick:()=>o("splitBill"),className:"px-3 py-1 rounded text-sm ".concat("splitBill"===d?"bg-purple-600 text-white":"bg-purple-100"),children:"Split Bills"}),(0,a.jsx)("button",{onClick:()=>o("payment"),className:"px-3 py-1 rounded text-sm ".concat("payment"===d?"bg-amber-600 text-white":"bg-amber-100"),children:"Payments"})]}),(0,a.jsx)("div",{className:"mb-4 flex justify-end",children:(0,a.jsx)("button",{onClick:j,disabled:x,className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 disabled:bg-gray-300 flex items-center gap-2",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"animate-spin",children:"⟳"})," Recovering..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"\uD83D\uDD04"})," Recover Audit Records"]})})}),s?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):c?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"bg-red-100 p-4 rounded-lg text-red-700 mb-4",children:c}),(0,a.jsx)("p",{children:"Please try again later or contact support."})]}):0===b.length?(0,a.jsx)("div",{className:"bg-white p-8 rounded-lg shadow text-center",children:(0,a.jsx)("p",{children:"No records found for the selected filter."})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100",children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status/Action"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.sort((e,t)=>t.timestamp-e.timestamp).map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(g(e.recordType)),children:"payment"===e.recordType?"Payment":"invoice"===e.recordType?"Invoice":"payroll"===e.recordType?"Payroll":"Split Bill"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h(e.timestamp)}),(0,a.jsx)("td",{className:"px-6 py-4",children:"payment"===e.recordType?(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Amount: ",e.totalAmount.toFixed(6)," ",e.chain]}),e.paymentId&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Payment ID: ",e.paymentId]}),(0,a.jsxs)("div",{className:"text-xs font-mono mt-1",children:[(0,a.jsxs)("p",{children:["From: ",u(e.walletAddresses[0]||"")]}),(0,a.jsxs)("p",{children:["To: ",u(e.walletAddresses[1]||"")]})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Total: ",e.totalAmount," ",e.chain]}),"payroll"===e.recordType&&e.walletAddresses.length>1&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Recipients:"}),e.walletAddresses.map((t,s)=>{var r,l;return(0,a.jsxs)("div",{className:"flex justify-between text-xs font-mono mb-1",children:[(0,a.jsx)("span",{children:u(t)}),(0,a.jsxs)("span",{className:"ml-4",children:[null!=(l=null==(r=e.amounts)?void 0:r[s])?l:"—"," ",e.chain]})]},s)})]}),("payroll"!==e.recordType||e.walletAddresses.length<=1)&&(0,a.jsx)("div",{className:"text-xs font-mono mt-1",children:e.walletAddresses.map((e,t)=>(0,a.jsx)("div",{children:u(e)},t))})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:"payment"===e.recordType&&e.paymentAction?(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(y(e.paymentAction)),children:e.paymentAction.toUpperCase()}):(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("paid"===e.status||"completed"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.transactionHash?(0,a.jsx)("a",{href:"https://suiexplorer.com/txblock/".concat(e.transactionHash,"?network=testnet"),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-xs font-mono",children:u(e.transactionHash)}):(0,a.jsx)("span",{className:"text-gray-400",children:"—"})})]},t))})]})})}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500",children:[(0,a.jsx)("p",{children:"Data stored on Sui blockchain via Walrus testnet with 10 epoch retention."}),(0,a.jsx)("p",{children:"This audit log provides an immutable record of all financial transactions."})]})]})}},90264:(e,t,s)=>{Promise.resolve().then(s.bind(s,9718))}},e=>{var t=t=>e(e.s=t);e.O(0,[4134,3464,3791,8441,1684,7358],()=>t(90264)),_N_E=e.O()}]);