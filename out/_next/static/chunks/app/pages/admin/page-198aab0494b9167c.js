(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3981],{5196:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},13717:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},19946:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(12115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:i="",children:c,iconNode:g,...x}=e;return(0,r.createElement)("svg",{ref:t,...d,width:s,height:s,stroke:a,strokeWidth:o?24*Number(n)/Number(s):n,className:l("lucide",i),...x},[...g.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),o=(e,t)=>{let a=(0,r.forwardRef)((a,d)=>{let{className:o,...i}=a;return(0,r.createElement)(n,{ref:d,iconNode:t,className:l("lucide-".concat(s(e)),o),...i})});return a.displayName="".concat(e),a}},33786:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},36789:(e,t,a)=>{Promise.resolve().then(a.bind(a,51918)),Promise.resolve().then(a.bind(a,87704))},41561:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var r=a(74228);let s="1807",l={buy:async(e,t)=>{if(!t)throw Error("Receipt file is required for buy transactions");let a=new FormData;return a.append("receipt",t),Object.keys(e).forEach(t=>{a.append(t,e[t])}),console.log("Sending buy request with file:",t.name),(await r.A.post("/buyOrders/buy",a,{headers:{"Content-Type":"multipart/form-data"}})).data},sell:async(e,t)=>{let a=new FormData;return a.append("qrImage",t),Object.keys(e).forEach(t=>{a.append(t,e[t])}),(await r.A.post("/sellOrders/sell",a,{headers:{"Content-Type":"multipart/form-data"}})).data},getUserBuyOrders:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3?arguments[3]:void 0,l=new URLSearchParams({page:t.toString(),limit:a.toString()});return s&&l.append("status",s),(await r.A.get("/buyOrders/wallet/".concat(e,"?").concat(l))).data},getUserSellOrders:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3?arguments[3]:void 0,l=new URLSearchParams({page:t.toString(),limit:a.toString()});return s&&l.append("status",s),(await r.A.get("/sellOrders/wallet/".concat(e,"?").concat(l))).data},getExchangeRates:async e=>{try{return(await r.A.get("/exchange-rates/".concat(e))).data}catch(e){throw console.error("Error fetching exchange rates:",e),e}},admin:{getAllBuyOrders:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=new URLSearchParams({page:e.toString(),limit:t.toString(),token:s,...a});return(await r.A.get("/buyOrders/all?".concat(l))).data},getBuyOrderById:async e=>(await r.A.get("/buyOrders/detail/".concat(e,"?token=").concat(s))).data,updateBuyOrderStatus:async(e,t,a)=>(await r.A.put("/buyOrders/".concat(e,"/status"),{status:t,notes:a,token:s})).data,completeBuyOrder:async(e,t)=>(await r.A.put("/buyOrders/".concat(e,"/complete"),{transactionHash:t,token:s})).data,getAllSellOrders:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=new URLSearchParams({page:e.toString(),limit:t.toString(),token:s,...a});return(await r.A.get("/sellOrders/all?".concat(l))).data},getSellOrderById:async e=>(await r.A.get("/sellOrders/detail/".concat(e,"?token=").concat(s))).data,updateSellOrderStatus:async(e,t,a)=>(await r.A.put("/sellOrders/".concat(e,"/status"),{status:t,notes:a,token:s})).data,completeSellOrder:async(e,t)=>{let a=new FormData;return a.append("paymentProof",t),a.append("token",s),console.log("Uploading payment proof for order:",e),(await r.A.put("/sellOrders/".concat(e,"/complete"),a,{headers:{"Content-Type":"multipart/form-data"}})).data}}}},46520:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});let r="https://payzoll-server-pharos.onrender.com"},51918:(e,t,a)=>{"use strict";a.d(t,{default:()=>y});var r=a(95155),s=a(12115),l=a(41561),d=a(35695),n=a(46520),o=a(53904),i=a(92657),c=a(13717),g=a(5196),x=a(54416),h=a(33786);let y=()=>{let[e,t]=(0,s.useState)([]),[a,y]=(0,s.useState)(!0),[m,u]=(0,s.useState)(""),[p,b]=(0,s.useState)(1),[j,f]=(0,s.useState)(1),[k,v]=(0,s.useState)(""),[N,w]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[P,A]=(0,s.useState)(!1),[O,I]=(0,s.useState)(!1),[E,R]=(0,s.useState)(""),[F,D]=(0,s.useState)(""),[M,T]=(0,s.useState)(!1);(0,d.useRouter)();let[B,H]=(0,s.useState)({}),U=async()=>{try{y(!0),u("");let e={};k&&(e.status=k);let a=await l.h.admin.getAllBuyOrders(p,10,e);a.success?(t(a.data),f(a.pagination.pages)):u(a.message||"Failed to load orders")}catch(e){u("Error fetching orders. Please try again."),console.error(e)}finally{y(!1)}};(0,s.useEffect)(()=>{U()},[p,k]);let L=async(e,t)=>{try{T(!0);let a=await l.h.admin.updateBuyOrderStatus(e,t,F);a.success?(U(),S(!1),D("")):u(a.message||"Failed to update status")}catch(e){u("Error updating order. Please try again."),console.error(e)}finally{T(!1)}},q=async()=>{if(N){if(!E.trim())return void u("Transaction hash is required");try{T(!0);let e=await l.h.admin.completeBuyOrder(N.orderId,E);e.success?(U(),S(!1),R("")):u(e.message||"Failed to complete order")}catch(e){u("Error completing order. Please try again."),console.error(e)}finally{T(!1)}}},z=async()=>{if(N&&B)try{if(T(!0),B.status!==N.status||B.notes!==N.notes){let e=await l.h.admin.updateBuyOrderStatus(N.orderId,B.status||N.status,B.notes);if(!e.success)throw Error(e.message||"Failed to update order")}if("completed"===B.status&&B.transactionHash){let e=await l.h.admin.completeBuyOrder(N.orderId,B.transactionHash);if(!e.success)throw Error(e.message||"Failed to complete order")}await U(),A(!1)}catch(e){console.error(e),u("Error updating order. Please try again.")}finally{T(!1)}},_=e=>{switch(e){case"pending":return"bg-yellow-500";case"processing":return"bg-blue-500";case"completed":return"bg-green-500";case"failed":return"bg-red-500";default:return"bg-gray-500"}},Q=e=>{w(e),H({status:e.status,notes:e.notes||"",transactionHash:e.transactionHash||""}),A(!0)};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 text-gray-900 dark:text-gray-100",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"Buy Order Management"}),m&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:m}),(0,r.jsxs)("div",{className:"flex justify-between mb-6",children:[(0,r.jsxs)("select",{className:"border rounded p-2 w-48 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-700",value:k,onChange:e=>v(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"All Statuses"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"processing",children:"Processing"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"failed",children:"Failed"})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsxs)("button",{className:"bg-blue-500 dark:bg-gray-700 hover:bg-blue-600 dark:hover:bg-gray-600 text-white font-bold py-2 px-4 rounded flex items-center",onClick:()=>U(),children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:"Refresh"})]})})]}),a?(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 shadow-md rounded",children:(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-600",children:[(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Order ID"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Date"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Wallet"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Amount"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Fiat"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Status"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Receipt"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.length>0?e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,r.jsx)("td",{className:"py-3 px-4 text-gray-900 dark:text-gray-100",children:e.orderId}),(0,r.jsx)("td",{className:"py-3 px-4 text-gray-900 dark:text-gray-100",children:new Date(e.createdAt).toLocaleString()}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("span",{className:"text-gray-900 dark:text-gray-100 hover:text-blue-500 dark:hover:text-blue-400 cursor-pointer",children:[e.wallet.substring(0,6),"...",e.wallet.substring(e.wallet.length-4)]})}),(0,r.jsxs)("td",{className:"py-3 px-4 text-gray-900 dark:text-gray-100",children:[e.amountToken," ",e.tokenBought]}),(0,r.jsxs)("td",{className:"py-3 px-4 text-gray-900 dark:text-gray-100",children:[e.amountFiat," ",e.fiatType]}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:"".concat(_(e.status)," text-white px-2 py-1 rounded-full text-xs"),children:e.status})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("button",{className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded text-sm flex items-center",onClick:()=>{w(e),I(!0)},children:[(0,r.jsx)(i.A,{className:"h-3 w-3 mr-1"}),"View"]})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsxs)("button",{className:"bg-yellow-500 hover:bg-yellow-600 text-white py-1 px-2 rounded text-sm flex items-center",onClick:()=>Q(e),children:[(0,r.jsx)(c.A,{className:"h-3 w-3 mr-1"}),"Edit"]}),"completed"!==e.status&&"failed"!==e.status&&(0,r.jsxs)("button",{className:"bg-green-500 hover:bg-green-700 text-white py-1 px-2 rounded text-sm flex items-center",onClick:()=>{w(e),R(e.transactionHash||""),S(!0)},children:[(0,r.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"Complete"]}),"completed"!==e.status&&"failed"!==e.status&&(0,r.jsxs)("button",{className:"bg-red-500 hover:bg-red-700 text-white py-1 px-2 rounded text-sm flex items-center",onClick:()=>{w(e),D(""),L(e.orderId,"failed")},children:[(0,r.jsx)(x.A,{className:"h-3 w-3 mr-1"}),"Reject"]}),e.transactionHash&&(0,r.jsxs)("a",{href:"https://etherscan.io/tx/".concat(e.transactionHash),target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded text-sm flex items-center",children:[(0,r.jsx)(h.A,{className:"h-3 w-3 mr-1"}),"View Tx"]})]})})]},e._id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:8,className:"py-4 text-center text-gray-500 dark:text-gray-400",children:"No orders found."})})})]})}),j>1&&(0,r.jsxs)("div",{className:"flex justify-center items-center mt-6",children:[(0,r.jsx)("button",{className:"bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 font-semibold py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-l disabled:opacity-50",disabled:1===p,onClick:()=>b(e=>Math.max(1,e-1)),children:"Previous"}),(0,r.jsxs)("span",{className:"px-4 py-2 text-gray-900 dark:text-gray-100",children:["Page ",p," of ",j]}),(0,r.jsx)("button",{className:"bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 font-semibold py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-r disabled:opacity-50",disabled:p===j,onClick:()=>b(e=>Math.min(j,e+1)),children:"Next"})]})]}),C&&N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Complete Buy Order"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>S(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"mb-4 text-gray-900 dark:text-gray-100",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",N.orderId]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Wallet:"})," ",N.wallet]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Amount:"})," ",N.amountToken," ",N.tokenBought]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Payment:"})," ",N.amountFiat," ",N.fiatType]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Transaction Hash"}),(0,r.jsx)("input",{type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500",value:E,onChange:e=>R(e.target.value),placeholder:"Enter blockchain transaction hash"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs mt-1",children:"Enter the transaction hash for this payment"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Notes (Optional)"}),(0,r.jsx)("textarea",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2,value:F,onChange:e=>D(e.target.value),placeholder:"Enter any notes for this transaction"})]}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded mr-2",onClick:()=>S(!1),children:"Cancel"}),(0,r.jsx)("button",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded ".concat(M||!E.trim()?"opacity-50 cursor-not-allowed":""),onClick:q,disabled:M||!E.trim(),children:M?"Processing...":"Complete Order"})]})]})}),P&&N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Edit Buy Order"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>A(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"mb-4 text-gray-900 dark:text-gray-100",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",N.orderId]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Customer:"})," ",N.wallet.substring(0,6),"...",N.wallet.substring(N.wallet.length-4)]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Amount:"})," ",N.amountToken," ",N.tokenBought]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Fiat:"})," ",N.amountFiat," ",N.fiatType]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Created:"})," ",new Date(N.createdAt).toLocaleString()]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Status"}),(0,r.jsxs)("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500",value:B.status||N.status,onChange:e=>H({...B,status:e.target.value}),children:[(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"processing",children:"Processing"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"failed",children:"Failed"})]})]}),"completed"===B.status&&!N.transactionHash&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Transaction Hash"}),(0,r.jsx)("input",{type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500",value:B.transactionHash||"",onChange:e=>H({...B,transactionHash:e.target.value}),placeholder:"Enter blockchain transaction hash"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs mt-1",children:"Required to set status to 'completed'"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Notes"}),(0,r.jsx)("textarea",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:B.notes||"",onChange:e=>H({...B,notes:e.target.value}),placeholder:"Enter any notes for this order"})]}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded mr-2",onClick:()=>A(!1),children:"Cancel"}),(0,r.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded ".concat(!M&&("completed"!==B.status||N.transactionHash||B.transactionHash)?"":"opacity-50 cursor-not-allowed"),onClick:z,disabled:M||"completed"===B.status&&!N.transactionHash&&!B.transactionHash,children:M?"Saving...":"Save Changes"})]})]})}),O&&N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-4xl w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Payment Receipt"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>I(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"text-center text-gray-900 dark:text-gray-100",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",N.orderId]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Amount:"})," ",N.amountFiat," ",N.fiatType]})]}),(0,r.jsx)("div",{className:"border p-2 border-gray-300 dark:border-gray-600",children:(0,r.jsx)("img",{src:"".concat(n.p).concat(N.paymentReceiptPath),alt:"Payment Receipt",className:"max-w-full max-h-96 mx-auto"})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded",onClick:()=>I(!1),children:"Close"})})]})]})})]})}},53904:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},54416:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},74228:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var r=a(23464);let s=a(46520).p,l=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=localStorage.getItem("authToken");return t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{let{response:t}=e;return(null==t?void 0:t.status)===401&&(localStorage.removeItem("authToken"),window.location.href="/"),Promise.reject({status:null==t?void 0:t.status,message:"object"==typeof(null==t?void 0:t.data)&&(null==t?void 0:t.data)&&"message"in t.data?t.data.message:"An unexpected error occurred",data:null==t?void 0:t.data,originalError:e})});let d=l},87704:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var r=a(95155),s=a(12115),l=a(41561),d=a(35695),n=a(46520),o=a(53904);let i=()=>{let[e,t]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[c,g]=(0,s.useState)(""),[x,h]=(0,s.useState)(1),[y,m]=(0,s.useState)(1),[u,p]=(0,s.useState)(""),[b,j]=(0,s.useState)(null),[f,k]=(0,s.useState)(!1),[v,N]=(0,s.useState)(!1),[w,C]=(0,s.useState)(!1),[S,P]=(0,s.useState)(null),[A,O]=(0,s.useState)(""),[I,E]=(0,s.useState)(!1),R=(0,s.useRef)(null);(0,d.useRouter)();let[F,D]=(0,s.useState)(null),[M,T]=(0,s.useState)(!1),[B,H]=(0,s.useState)(!1),U=async()=>{try{i(!0),g("");let e={};u&&(e.status=u);let a=await l.h.admin.getAllSellOrders(x,10,e);a.success?(t(a.data),m(a.pagination.pages)):g(a.message||"Failed to load orders")}catch(e){g("Error fetching orders. Please try again."),console.error(e)}finally{i(!1)}};(0,s.useEffect)(()=>{U()},[x,u]);let L=async(e,t)=>{try{E(!0);let a=await l.h.admin.updateSellOrderStatus(e,t,A);a.success?(U(),k(!1),O("")):g(a.message||"Failed to update status")}catch(e){g("Error updating order. Please try again."),console.error(e)}finally{E(!1)}},q=async()=>{if(!b||!F)return void alert("Please select a payment proof file");try{H(!0),console.log("Completing order with file:",F.name),await l.h.admin.completeSellOrder(b.orderId,F),alert("Order completed successfully!"),U(),T(!1)}catch(e){console.error("Error completing order:",e),alert("Failed to complete order. Please try again.")}finally{H(!1)}},z=async()=>{if(!b||!S)return void g("Payment proof is required");try{E(!0);let e=await l.h.admin.completeSellOrder(b.orderId,S);e.success?(U(),k(!1),P(null),R.current&&(R.current.value="")):g(e.message||"Failed to complete order")}catch(e){g("Error completing order. Please try again."),console.error(e)}finally{E(!1)}},_=e=>{switch(e){case"pending":return"bg-yellow-500";case"processing":return"bg-blue-500";case"completed":return"bg-green-500";case"failed":return"bg-red-500";default:return"bg-gray-500"}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 text-gray-900 dark:text-gray-100",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"Admin Sell Order Management"}),c&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),(0,r.jsxs)("div",{className:"flex justify-between mb-6",children:[(0,r.jsxs)("select",{className:"border rounded p-2 w-48 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-700",value:u,onChange:e=>p(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"All Statuses"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"processing",children:"Processing"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"failed",children:"Failed"})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsxs)("button",{className:"bg-blue-500 dark:bg-gray-700 hover:bg-blue-600 dark:hover:bg-gray-600 text-white font-bold py-2 px-4 rounded flex items-center",onClick:()=>U(),children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:"Refresh"})]})})]}),a?(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow",children:(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-600",children:[(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Order ID"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Date"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Wallet"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Amount"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Fiat"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Status"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Payment Method"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Payment Details"}),(0,r.jsx)("th",{className:"py-2 px-3 text-left",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.length>0?e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,r.jsx)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:e.orderId}),(0,r.jsx)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:new Date(e.createdAt).toLocaleString()}),(0,r.jsx)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:(0,r.jsxs)("span",{title:e.wallet,children:[e.wallet.substring(0,6),"...",e.wallet.substring(e.wallet.length-4)]})}),(0,r.jsxs)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:[e.amountToken," ",e.tokenSold]}),(0,r.jsxs)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:[e.amountFiat," ",e.fiatType]}),(0,r.jsx)("td",{className:"py-2 px-3",children:(0,r.jsx)("span",{className:"".concat(_(e.status)," text-white px-2 py-1 rounded-full text-xs"),children:e.status})}),(0,r.jsx)("td",{className:"py-2 px-3 text-gray-900 dark:text-gray-100",children:"UPI"}),(0,r.jsx)("td",{className:"py-2 px-3",children:(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{className:"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold py-1 px-2 rounded text-sm",onClick:()=>{j(e),N(!0)},children:"View Details"}),e.paymentQrPath&&(0,r.jsx)("button",{className:"bg-indigo-200 dark:bg-gray-700 hover:bg-indigo-300 dark:hover:bg-gray-600 text-indigo-800 dark:text-gray-200 font-semibold py-1 px-2 rounded text-sm",onClick:()=>{j(e),C(!0)},children:"View QR"})]})}),(0,r.jsxs)("td",{className:"py-2 px-3",children:["completed"!==e.status&&"failed"!==e.status&&(0,r.jsxs)("div",{className:"flex space-x-1",children:["pending"===e.status&&(0,r.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded text-sm",onClick:()=>{j(e),L(e.orderId,"processing")},children:"Process"}),(0,r.jsx)("button",{className:"bg-green-500 hover:bg-green-700 text-white py-1 px-2 rounded text-sm",onClick:()=>{j(e),D(null),T(!0)},children:"Complete"}),(0,r.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white py-1 px-2 rounded text-sm",onClick:()=>{j(e),L(e.orderId,"failed")},children:"Reject"})]}),"completed"===e.status&&e.paymentProofPath&&(0,r.jsx)("button",{className:"bg-purple-500 hover:bg-purple-700 text-white py-1 px-2 rounded text-sm",onClick:()=>window.open("".concat(n.p).concat(e.paymentProofPath),"_blank"),children:"View Payment"})]})]},e._id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:9,className:"py-4 text-center text-gray-500 dark:text-gray-400",children:"No orders found."})})})]})}),y>1&&(0,r.jsxs)("div",{className:"flex justify-center items-center mt-6",children:[(0,r.jsx)("button",{className:"bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 font-semibold py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-l disabled:opacity-50",disabled:1===x,onClick:()=>h(e=>Math.max(1,e-1)),children:"Previous"}),(0,r.jsxs)("span",{className:"px-4 py-2 text-gray-900 dark:text-gray-100",children:["Page ",x," of ",y]}),(0,r.jsx)("button",{className:"bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 font-semibold py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-r disabled:opacity-50",disabled:x===y,onClick:()=>h(e=>Math.min(y,e+1)),children:"Next"})]})]}),f&&b&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Complete Sell Order"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>k(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",b.orderId]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Customer:"})," ",b.wallet.substring(0,6),"...",b.wallet.substring(b.wallet.length-4)]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Sold:"})," ",b.amountToken," ",b.tokenSold]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"To Pay:"})," ",b.amountFiat," ",b.fiatType]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Payment Method:"})," ","upi"===b.paymentMethod?"UPI":"bank"===b.paymentMethod?"Bank Transfer":"QR Code"]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Upload Payment Proof"}),(0,r.jsx)("input",{type:"file",ref:R,onChange:e=>{e.target.files&&e.target.files[0]&&P(e.target.files[0])},accept:"image/*",className:"w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 dark:file:bg-gray-700 file:text-blue-700 dark:file:text-gray-200 hover:file:bg-blue-100 dark:hover:file:bg-gray-600"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs mt-1",children:"Upload a screenshot of the payment you made to the customer"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-bold mb-2",children:"Notes (Optional)"}),(0,r.jsx)("textarea",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-gray-300 leading-tight focus:outline-none focus:shadow-outline",rows:2,value:A,onChange:e=>O(e.target.value),placeholder:"Enter any notes for this transaction"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>k(!1),children:"Cancel"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-green-500 dark:bg-green-600 text-white rounded hover:bg-green-600 dark:hover:bg-green-700 disabled:opacity-50",onClick:z,disabled:I||!S,children:I?"Processing...":"Complete Order"})]})]})}),v&&b&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Payment Details"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>N(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",b.orderId]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Payment Method:"})," UPI"]})]}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:b.paymentDetails.startsWith("data:image")?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"mb-2 font-medium text-gray-900 dark:text-gray-100",children:"Customer's QR Code:"}),(0,r.jsx)("img",{src:"".concat(n.p).concat(b.paymentQrPath),alt:"Payment QR Code",className:"max-w-full h-auto max-h-60 mx-auto border border-gray-300 dark:border-gray-600 p-1 rounded"})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Customer's Payment Details:"}),(0,r.jsx)("p",{className:"mt-2 p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded",children:b.paymentDetails})]})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Use these details to make payment to the customer, then upload proof of payment to complete the order."})}),(0,r.jsx)("div",{className:"flex justify-end mt-4",children:(0,r.jsx)("button",{className:"bg-blue-500 dark:bg-gray-700 hover:bg-blue-600 dark:hover:bg-gray-600 text-white font-bold py-2 px-4 rounded",onClick:()=>{N(!1),"completed"!==b.status&&"failed"!==b.status&&k(!0)},children:"completed"===b.status?"Close":"Proceed to Complete Order"})})]})}),w&&b&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-4xl w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Customer QR Code"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>C(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:[(0,r.jsx)("strong",{children:"Order ID:"})," ",b.orderId]}),(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:[(0,r.jsx)("strong",{children:"Customer UPI:"})," ",b.paymentDetails]})]}),(0,r.jsx)("div",{className:"border p-2 bg-white dark:bg-gray-800",children:(0,r.jsx)("img",{src:"".concat(n.p).concat(b.paymentQrPath),alt:"Payment QR Code",className:"max-w-full max-h-96 mx-auto"})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-2 px-4 rounded",onClick:()=>C(!1),children:"Close"})})]})]})}),M&&b&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Upload Payment Proof"}),(0,r.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",onClick:()=>T(!1),children:"\xd7"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"mb-4 text-gray-900 dark:text-gray-100",children:["Order ID: ",b.orderId]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload Payment Proof"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files.length>0&&D(e.target.files[0])},className:"w-full p-2 border rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),F&&(0,r.jsx)("div",{className:"mb-4 p-2 border rounded bg-gray-50 dark:bg-gray-700",children:(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:["Selected file: ",F.name]})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{className:"bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded",onClick:()=>T(!1),children:"Cancel"}),(0,r.jsx)("button",{className:"bg-green-600 dark:bg-green-700 hover:bg-green-700 dark:hover:bg-green-800 text-white px-4 py-2 rounded",onClick:q,disabled:!F||B,children:B?"Processing...":"Complete Order"})]})]})]})})]})}},92657:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[4134,3464,8441,1684,7358],()=>t(36789)),_N_E=e.O()}]);